{# Reusable macros for templates #}

{% macro pagination(pagination, endpoint, extra_params=None) %}
{% if pagination.pages > 1 %}
{% set params = extra_params or {} %}
<nav class="flex flex-col sm:flex-row items-center justify-between gap-4 mt-6" aria-label="Page navigation">
    <div class="flex items-center gap-1">
        {# Previous button #}
        {% if pagination.has_prev %}
        <a href="{{ url_for(endpoint, page=pagination.page - 1, **params) }}"
           class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition">
            &laquo; Previous
        </a>
        {% else %}
        <span class="px-3 py-2 text-sm font-medium text-gray-400 bg-gray-50 border border-gray-200 rounded-lg cursor-not-allowed">
            &laquo; Previous
        </span>
        {% endif %}

        {# Page numbers #}
        <div class="hidden sm:flex items-center gap-1">
            {% for p in range(1, pagination.pages + 1) %}
                {% if p == pagination.page %}
                <span class="px-3 py-2 text-sm font-medium text-white bg-primary-600 border border-primary-600 rounded-lg">
                    {{ p }}
                </span>
                {% elif p == 1 or p == pagination.pages or (p >= pagination.page - 2 and p <= pagination.page + 2) %}
                <a href="{{ url_for(endpoint, page=p, **params) }}"
                   class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition">
                    {{ p }}
                </a>
                {% elif p == pagination.page - 3 or p == pagination.page + 3 %}
                <span class="px-2 py-2 text-sm text-gray-500">...</span>
                {% endif %}
            {% endfor %}
        </div>

        {# Next button #}
        {% if pagination.has_next %}
        <a href="{{ url_for(endpoint, page=pagination.page + 1, **params) }}"
           class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition">
            Next &raquo;
        </a>
        {% else %}
        <span class="px-3 py-2 text-sm font-medium text-gray-400 bg-gray-50 border border-gray-200 rounded-lg cursor-not-allowed">
            Next &raquo;
        </span>
        {% endif %}
    </div>

    <div class="text-sm text-gray-500">
        Showing {{ ((pagination.page - 1) * pagination.per_page) + 1 }} -
        {{ min(pagination.page * pagination.per_page, pagination.total) }} of {{ pagination.total }}
    </div>
</nav>
{% endif %}
{% endmacro %}


{# ---- Form Field Macros ---- #}

{% macro form_field_class() %}w-full border border-surface-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500{% endmacro %}

{% macro text_input(name, label, value='', required=false, placeholder='', type='text', maxlength=none) %}
<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">{{ label }}{% if required %} *{% endif %}</label>
    <input type="{{ type }}" name="{{ name }}" value="{{ value }}"
           {% if required %}required{% endif %}
           {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
           {% if maxlength %}maxlength="{{ maxlength }}"{% endif %}
           class="{{ form_field_class() }}">
</div>
{% endmacro %}

{% macro textarea_input(name, label, value='', required=false, placeholder='', rows=3) %}
<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">{{ label }}{% if required %} *{% endif %}</label>
    <textarea name="{{ name }}" rows="{{ rows }}"
           {% if required %}required{% endif %}
           {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
           class="{{ form_field_class() }}">{{ value }}</textarea>
</div>
{% endmacro %}

{% macro select_input(name, label, options, selected='', required=false, include_empty=true, empty_label='Select...') %}
<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">{{ label }}{% if required %} *{% endif %}</label>
    <select name="{{ name }}" {% if required %}required{% endif %} class="{{ form_field_class() }}">
        {% if include_empty %}
        <option value="">{{ empty_label }}</option>
        {% endif %}
        {% for value, display in options %}
        <option value="{{ value }}" {% if value == selected %}selected{% endif %}>{{ display }}</option>
        {% endfor %}
    </select>
</div>
{% endmacro %}

{% macro date_input(name, label, value='', required=false) %}
<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">{{ label }}{% if required %} *{% endif %}</label>
    <input type="date" name="{{ name }}" value="{{ value.strftime('%Y-%m-%d') if value else '' }}"
           {% if required %}required{% endif %}
           class="{{ form_field_class() }}">
</div>
{% endmacro %}

{% macro number_input(name, label, value='', required=false, min=none, max=none, step=none, placeholder='') %}
<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">{{ label }}{% if required %} *{% endif %}</label>
    <input type="number" name="{{ name }}" value="{{ value }}"
           {% if required %}required{% endif %}
           {% if min is not none %}min="{{ min }}"{% endif %}
           {% if max is not none %}max="{{ max }}"{% endif %}
           {% if step %}step="{{ step }}"{% endif %}
           {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
           class="{{ form_field_class() }}">
</div>
{% endmacro %}

{% macro checkbox_input(name, label, checked=false) %}
<div class="flex items-center gap-2">
    <input type="checkbox" name="{{ name }}" id="{{ name }}"
           {% if checked %}checked{% endif %}
           class="rounded border-surface-300 text-primary-600 focus:ring-primary-500">
    <label for="{{ name }}" class="text-sm text-gray-700">{{ label }}</label>
</div>
{% endmacro %}

{% macro form_actions(submit_label='Save', cancel_url=none, cancel_label='Cancel') %}
<div class="flex justify-between items-center pt-4 border-t border-surface-200">
    {% if cancel_url %}
    <a href="{{ cancel_url }}" class="text-gray-500 hover:text-gray-700">{{ cancel_label }}</a>
    {% else %}
    <div></div>
    {% endif %}
    <button type="submit" class="bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 font-medium">
        {{ submit_label }}
    </button>
</div>
{% endmacro %}
